# Бот для публикации изображений космоса

Бот для публикации изображений космоса - это проект на Python, который загружает и публикует изображения на космическую тематику от NASA и SpaceX в Telegram-канал. Бот загружает изображения NASA Earth Polychromatic Imaging Camera (EPIC), NASA Astronomy Picture of the Day (APOD) и запусков SpaceX.

## Предварительные требования

Прежде чем начать, убедитесь, что у вас установлено следующее:

* Python 3.7 или выше
* pip - установщик пакетов Python
* Virtualenv - Инструмент для создания изолированных сред Python
* Git - Система контроля версий

Вам также потребуется:

* Подключение к интернету
* Ключ API NASA
* Токен бота Telegram
* Канал в Telegram

## Установка

### 1. Клонируйте репозиторий

Начните с клонирования репозитория на ваш компьютер.

```bash
git clone https://github.com/Dmitriyrevilov/API-lessons4-
cd API-lessons4-
```

_Обратите внимание, что команда  `cd` (change directory) используется в Unix/Linux системах. Если вы используете Windows, вы можете использовать эту же команду в PowerShell или использовать команду `chdir` в командной строке (cmd)._

### 2. Настройка виртуального окружения

Далее создайте новое виртуальное окружение и активируйте его.

```bash
python3 -m venv venv
source venv/bin/activate  # для Unix систем
.\venv\Scripts\activate  # для Windows
```

### 3. Установите зависимости
С активированным виртуальным окружением установите зависимости проекта:

```bash
pip install -r requirements.txt
```

### 4. Настройка переменных окружения

Вам нужно настроить некоторые переменные окружения перед запуском бота. Создайте файл .env и добавьте переменные с вашим ключом API NASA, токеном бота Telegram и ID канала Telegram:

```
NASA_API_KEY=ваш_NASA_API_KEY
TELEGRAM_BOT_TOKEN=TELEGRAM_BOT_TOKEN
TELEGRAM_CHANNEL_ID=ваш_TELEGRAM_CHANNEL_ID
```

**Как получить ключ API NASA:**

Чтобы получить ключ API NASA, перейдите на https://api.nasa.gov/ и сгенерируйте свой собственный ключ API.

**Создание бота Telegram и получение токена:**

1. Откройте Telegram и найдите `BotFather`.
2. Начните чат и следуйте инструкциям для создания нового бота.
3. Как только бот будет создан, вы получите токен. Этот токен представляет вашего бота и используется для доступа к HTTP API.

**Создание канала Telegram и получение ID канала:**

1. В Telegram нажмите на меню и выберите 'Новый канал'.
2. Следуйте инструкциям для создания нового канала.
3. Как только канал будет создан, перейдите в 'Настройки канала' -> 'Информация о канале'.
4. Здесь вы можете скопировать ID канала (это будет часть после https://t.me/).

### 5. Запуск скриптов

Проект содержит несколько скриптов, которые вам нужно будет запустить:

**download_apod.py:**

Этот скрипт получает изображения APOD от NASA с помощью API и сохраняет его в локальной директории `apod_images/`.

Также можно установить через переменную окружения `APOD_DIRECTORY`.  Если задана и переменная окружения, и аргумент командной строки, аргумент командной строки имеет приоритет.

```bash
python download_apod.py  YYYY-MM-DD
```

```bash
python download_apod.py 2023-01-01 2023-01-05 --directory /путь/к/моим/apod/изображениям
```

_Вы можете указать дату изображения (YYYY - год, MM - месяц, DD - день)._

**download_epic.py:**

Этот скрипт получает изображения EPIC от NASA с помощью API и сохраняет их в локальной директории `epic_images/`.

Также можно установить через переменную окружения `EPIC_DIRECTORY`. Если задана и переменная окружения, и аргумент командной строки, аргумент командной строки имеет приоритет.

```bash
python download_epic.py --count 10
```

```bash
python download_epic.py --num_images 10 --directory /путь/к/моим/epic/изображениям
```

_Вы можете указать количество фотографий (вместо 15 - любое число от одного). Если не указано, по умолчанию загружается 5 фотографий._

**fetch_spacex_images.py:**

Этот скрипт получает фотографии запусков SpaceX и сохраняет их в локальной директории `images_spacex/`.

Также можно установить через переменную окружения `SPACEX_IMAGES_DIR`. Если задана и переменная окружения, и аргумент командной строки, аргумент командной строки имеет приоритет.

```bash
python fetch_spacex_images.py --launch_id sd237d47ffd86e000604bsa231
```

```bash
python fetch_spacex_images.py --flight_id 62ca44c952c9ff0007ba4593 --directory /путь/к/моим/spacex/изображениям
```

**telegram_publisher.py:**

Скрипт автоматически отправляет изображения в ваш Telegram-канал. Интервал между отправкой изображений по умолчанию составляет 4 часа, но его можно настроить.

```bash
python telegram_publisher.py --dir images_spacex --hours 4 --image spacex_0.png
```

_Команда загружает изображения из папки `images_spacexs/`,`epic_images/`,`apod_images/`, устанавливают интервал автоматической публикации изображений в часах и публикует указанную фотографию. Измените значения в соответствии с вашими потребностями._

## Завершение работы

Чтобы остановить бота, просто остановите скрипт, нажав Ctrl + C в терминале.

## Работа бота без остановки

Если вы хотите, чтобы ваш бот работал постоянно, скрипт должен быть постоянно запущен все это время.

## Дополнительная информация

Обратите внимание, что API_NASA может быть недоступен. Если это так, скрипты загрузки изображений (download_apod.py и download_epic.py) будут возвращать ошибку и не будут работать. Если это случилось, попробуйте воспользоваться скриптами позднее.

## Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков  [https://dvmn.org](https://dvmn.org).